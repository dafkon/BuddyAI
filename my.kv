#:import Label kivy.uix.label.Label

WindowManager:
    Loginwindow:
    Signupwindow:
    ForgotPassswordWindow:
    Homewindow:
<Loginwindow>
    name: "Login"
    canvas.before:
        Color:
            rgba: 207/255.0, 137/255.0, 202/255.0, 255/255.0
        Rectangle:
            pos: self.pos
            size: self.size
    Image:
        source: 'image\image.png'
        size_hint: 0.4,0.4
        pos_hint: {"x":0.31, "top":1}
    FloatLayout:
        TextInput:
            id:email
            foreground_color: [0,0,0,1]
            hint_text_color: [1,1,1,1]
            background_color: [207/255.0, 137/255.0, 202/255.0, 255/255.0]
            hint_text: "Email:"
            multiline: False
            font_size: 15
            pos_hint: {"x":0.20, "top":0.65}
            size_hint: 0.6, 0.05
        TextInput:
            id:password
            hint_text_color: [1,1,1,1]
            text_hint_color: [0,0,0,1]
            foreground_color: [0,0,0,1]
            background_color: [207/255.0, 137/255.0, 202/255.0, 255/255.0]
            hint_text: "Password:"
            multiline: False
            password: True
            font_size: 15
            pos_hint: {"x":0.20, "top":0.55}
            size_hint: 0.6, 0.05
            canvas.before:

        RoundedButton:
            font_size: 20
            pos_hint: {"x":0.3, "y":0.35}
            size_hint: 0.4, 0.05
            text:"Login"
            on_release:
                app.login(email.text, password.text)
                email.text = ''
                password.text = ''
                app.root.get_screen('Homewindow').helpsection()


        RoundedButton:
            font_size: 12
            background_color: 207/255.0, 137/255.0, 202/255.0, 255/255.0
            underline: True
            pos_hint: {"x":0.25, "y":0.28}
            size_hint: 0.5, 0.05
            text:"No Account? Why not sign up?"
            on_release:
                app.root.current = "Sign-Up"
                email.text = ''
                password.text = ''
                app.root.get_screen('Sign-Up').email = ''
                app.root.get_screen('Sign-Up').password = ''
                app.root.get_screen('Sign-Up').passwordretype = ''
        RoundedButton:
            font_size: 12
            background_color: 207/255.0, 137/255.0, 202/255.0, 255/255.0
            pos_hint: {"x":0.5, "y":0.47}
            underline: True
            size_hint: 0.3, 0.03
            text:"Forgot Password"
            on_release:
                app.root.current = "ForgotPassword"
                email.text = ''
                password.text = ''

<Signupwindow>
    name: "Sign-Up"
    canvas.before:
        Color:
            rgba: 207/255.0, 137/255.0, 202/255.0, 255/255.0
        Rectangle:
            pos: self.pos
            size: self.size
    Image:
        source: 'image\image.png'
        size_hint: 0.4,0.4
        pos_hint: {"x":0.32, "top":1}
    FloatLayout:

        TextInput:
            id:email
            foreground_color: [0,0,0,1]
            hint_text_color: [1,1,1,1]
            background_color: [207/255.0, 137/255.0, 202/255.0, 255/255.0]
            hint_text: "Email:"
            multiline: False
            font_size: 15
            pos_hint: {"x":0.20, "top":0.65}
            size_hint: 0.6, 0.05

        TextInput:
            id:password
            hint_text_color: [1,1,1,1]
            text_hint_color: [0,0,0,1]
            foreground_color: [0,0,0,1]
            background_color: [207/255.0, 137/255.0, 202/255.0, 255/255.0]
            hint_text: "Password:"
            multiline: False
            password: True
            font_size: 15
            pos_hint: {"x":0.20, "top":0.55}
            size_hint: 0.6, 0.05
            canvas.before:

        TextInput:
            id:passwordretype
            hint_text_color: [1,1,1,1]
            text_hint_color: [0,0,0,1]
            foreground_color: [0,0,0,1]
            background_color: [207/255.0, 137/255.0, 202/255.0, 255/255.0]
            hint_text: "Password:"
            multiline: False
            password: True
            font_size: 15
            pos_hint: {"x":0.20, "top":0.45}
            size_hint: 0.6, 0.05
            canvas.before:

        RoundedButton:
            font_size: 20
            pos_hint: {"x":0.3, "y":0.30}
            size_hint: 0.4, 0.05
            text:"Sign-up"
            on_release:
                if email != "" and password != "" and passwordretype != "": app.signup(email.text, password.text, passwordretype.text)
                else: app.sign_up_all_fiedls()


        RoundedButton:
            font_size: 20
            pos_hint: {"x":0.3, "y":0.24}
            size_hint: 0.4, 0.05
            text:"Cancel"
            on_release:
                app.root.current = "Login"
                email.text = ''
                password.text = ''
                passwordretype = ''

<ForgotPassswordWindow>
    name: "ForgotPassword"
    canvas.before:
        Color:
            rgba: 207/255.0, 137/255.0, 202/255.0, 255/255.0
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        background_color: (252/255.0, 157/255.0, 249/255.0)
        size_hint: 0.4, 0.05
    Image:
        source: 'image\image.png'
        size_hint: 0.4,0.4
        pos_hint: {"x":0.32, "top":1}
    FloatLayout:
        TextInput:
            id:email
            foreground_color: [0,0,0,1]
            hint_text_color: [1,1,1,1]
            background_color: [207/255.0, 137/255.0, 202/255.0, 255/255.0]
            hint_text: "Email:"
            multiline: False
            font_size: 15
            pos_hint: {"x":0.20, "top":0.55}
            size_hint: 0.6, 0.05

        RoundedButton:
            font_size: 15
            pos_hint: {"x":0.3, "y":0.35}
            size_hint: 0.4, 0.05
            text:"Change Password"
            on_release:
                app.forgotpassword(email.text)
                email.text = ''

        RoundedButton:
            font_size: 20
            pos_hint: {"x":0.3, "y":0.29}
            size_hint: 0.4, 0.05
            text:"Cancel"
            on_release:
                app.root.current = "Login"
                email.text = ''

<Homewindow>
    name: "Homewindow"
    canvas.before:
        Color:
            rgba: 207/255.0, 137/255.0, 202/255.0, 255/255.0
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        background_color: 252/255.0, 157/255.0, 249/255.0
        size_hint: 0.4, 0.05
    MDBoxLayout:
        orientation: 'vertical'

        #bottom nav used to navigate through pages
        MDBottomNavigation:
            #1st item
            MDBottomNavigationItem:
                name: 'Home Screen'
                text:"Home"
                icon: 'image\home.png'
                Image:
                    allow_stretch: True
                    size_hint: None, None
                    size: root.size
                FloatLayout:
                    canvas.before:
                        Color:
                            rgba: 207/255.0, 137/255.0, 202/255.0, 255/255.0
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    ScrollView:
                        MDList:
                            id: helpscreen

            #2nd item
            MDBottomNavigationItem:
                name: 'Chatbot Screen'
                text: "Buddy AI"
                icon: 'image\image.png'

                Image:
                    allow_stretch: True
                    size_hint: None, None
                    size: root.size

                FloatLayout:
                    canvas.before:
                        Color:
                            rgba: 207/255.0, 137/255.0, 202/255.0, 255/255.0
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    ScrollView:
                        MDList:
                            id: listlist

                    Button:
                        id: letschat
                        font_size: 20
                        text: "Lets Chat!!!"
                        background_color: 150/255.0, 100/255.0, 150/255.0, 255/255.0
                        pos_hint: {"x":0.3, "y":0.5}
                        size_hint: 0.4, 0.09
                        on_release:
                            app.user_message("Introduction")
                            listlist.add_widget(Label(text = app.message_response, markup=True, text_size=(360, None), font_size=15, padding=(20, 0), size=(500, 700)))
                            self.opacity = 0
                            self.disabled = True
                            user_input.disabled = False
                            submitinput.disabled = False

                    TextInput:
                        id: user_input
                        hint_text_color: [1,1,1,1]
                        text_hint_color: [0,0,0,1]
                        foreground_color: [0,0,0,1]
                        background_color: [207/255.0, 137/255.0, 202/255.0, 255/255.0]
                        hint_text: "Lets chat!!: "
                        multiline: False
                        disabled: True
                        font_size: 15
                        pos_hint: {"x":0.02, "top":0.062}
                        size_hint: 0.87, 0.055
                        canvas.before:

                    RoundedSubmitButton:
                        id: submitinput
                        font_size: 20
                        text: ">"
                        pos_hint: {"x":0.9, "top":0.06}
                        size_hint: 0.07, 0.05
                        radius: [10]
                        disabled: True
                        on_release:
                            app.user_message(user_input.text)
                            listlist.add_widget(Label(text = app.message_user, markup=True, text_size=(360, None), font_size=15, padding=(20, 0), size=(self.texture_size)))
                            listlist.add_widget(Label(text = app.message_response, markup=True, text_size=(360, None), font_size=15, padding=(20, 0), size=(500, 700)))
                            user_input.text = ''


            #3rd item
            MDBottomNavigationItem:
                name: 'Settings'
                text: "Settings"
                icon: 'image\gear.png'

                Image:
                    allow_stretch: True
                    size_hint: None, None
                    size: root.size
                FloatLayout:
                    canvas.before:
                        Color:
                            rgba: 207/255.0, 137/255.0, 202/255.0, 255/255.0
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    ScrollView:
                        MDList:
                            OneLineListItem:
                                id: Sign-Out
                                text: "Sign Out"
                                on_release:
                                    app.root.current = "Login"
                                    if letschat.disabled == True: listlist.clear_widgets()
                                    letschat.opacity = 1
                                    letschat.disabled = False
                                    user_input.disabled = True
                                    submitinput.disabled = True
                                    pass_change.disabled = False
                                    pass_change.opacity = 1
                                    helpscreen.clear_widgets()
                                    app.signout()


                            OneLineListItem:
                                id: delete
                                text: "Delete Account"
                                on_release:
                                    app.popupwindow_DeleteUser()
                                    if letschat.disabled == True: listlist.clear_widgets()
                                    letschat.opacity = 1
                                    letschat.disabled = False
                                    user_input.disabled = True
                                    submitinput.disabled = True
                                    app.message_history = ""

                            OneLineListItem:
                                id: Clear_history
                                text: "Clear Chat History"
                                on_release:
                                    app.Deletechats()
                                    if letschat.disabled == True: listlist.clear_widgets()
                                    letschat.opacity = 1
                                    letschat.disabled = False
                                    user_input.disabled = True
                                    submitinput.disabled = True
                                    app.message_history = ""

                            OneLineListItem:
                                id: wipe_chats
                                text: "Clear chat widgets"
                                on_release:
                                    if letschat.disabled == True: listlist.clear_widgets()
                                    app.clear_chatbot_widgets()

                            OneLineListItem:
                                id: past_convos
                                text: "Show past conversations"
                                on_release:
                                    if letschat.disabled == True: listlist.clear_widgets()
                                    if letschat.disabled == True: app.root.get_screen('Homewindow').historyloader()
                                    app.Showhistroy_popup()

                            OneLineListItem:
                                id: pass_change
                                text: "Change password"
                                on_release:
                                    app.forgotpassword(app.get_email())
                                    self.opacity = 0.5
                                    self.disabled = True

<RoundedButton@Button>
    background_color: (0,0,0,0)
    background_normal: ''
    canvas.before:
        Color:
            rgba: 150/255.0, 100/255.0, 150/255.0, 255/255.0
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [10]

<RoundedSubmitButton@Button>
    background_color: (0,0,0,0)
    canvas.before:
        Color:
            rgba: 150/255.0, 100/255.0, 150/255.0, 255/255.0
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [30]